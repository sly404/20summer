<!DOCTYPE html>
<!-- 编辑人：施立耀 -->
<html>
	<head>
		<meta charset="utf-8" />
		<title>Highdmin - Responsive Bootstrap 4 Admin Dashboard</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
		<meta content="Coderthemes" name="author" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<!-- App favicon -->
		<link rel="shortcut icon" href="assets/images/favicon.ico">

		<!--Footable-->
		<link href="../plugins/footable/css/footable.core.css" rel="stylesheet">

		<!-- App css -->
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<link href="assets/css/icons.css" rel="stylesheet" type="text/css" />
		<link href="assets/css/style.css" rel="stylesheet" type="text/css" />

		<script src="assets/js/modernizr.min.js"></script>

		<style>
			table td {
			            max-width: 100px;
			            word-wrap: break-word;
			            text-overflow: ellipsis;
			            white-space: nowrap;
			            overflow: hidden;
						table-layout: fixed
			        }
			/* table td:hover {
			            white-space: normal;
			            overflow: auto;
			        } */
		</style>

	</head>

	<body>

		<!-- Navigation Bar-->
		<header id="topnav">
			<div class="topbar-main">
				<div class="container-fluid">

					<!-- Logo container-->
					<div class="logo">
						<!-- Text Logo -->
						<!-- <a href="index.html" class="logo">
                            <span class="logo-small"><i class="mdi mdi-radar"></i></span>
                            <span class="logo-large"><i class="mdi mdi-radar"></i> Highdmin</span>
                        </a> -->
						<!-- Image Logo -->
						<a href="index.html" class="logo">
							<img src="assets/images/logo_sm.png" alt="" height="26" class="logo-small">
							<img src="assets/images/logo.png" alt="" height="40" class="logo-large">
						</a>

					</div>
					<!-- End Logo container-->


					<div class="menu-extras topbar-custom">

						<ul class="list-unstyled topbar-right-menu float-right mb-0">

							<li class="menu-item">
								<!-- Mobile menu toggle-->
								<a class="navbar-toggle nav-link">
									<div class="lines">
										<span></span>
										<span></span>
										<span></span>
									</div>
								</a>
								<!-- End mobile menu toggle-->
							</li>
							<li class="dropdown notification-list hide-phone">
								<a class="nav-link dropdown-toggle waves-effect nav-user" data-toggle="dropdown" href="#" role="button"
								 aria-haspopup="false" aria-expanded="false">
									<i class="mdi mdi-earth"></i> English <i class="mdi mdi-chevron-down"></i>
								</a>
								<div class="dropdown-menu dropdown-menu-right">

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item">
										Spanish
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item">
										Italian
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item">
										French
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item">
										Russian
									</a>

								</div>
							</li>

							<li class="dropdown notification-list">
								<a class="nav-link dropdown-toggle arrow-none waves-effect" data-toggle="dropdown" href="#" role="button"
								 aria-haspopup="false" aria-expanded="false">
									<i class="fi-bell noti-icon"></i>
									<span class="badge badge-danger badge-pill noti-icon-badge">4</span>
								</a>
								<div class="dropdown-menu dropdown-menu-right dropdown-lg">

									<!-- item-->
									<div class="dropdown-item noti-title">
										<h6 class="m-0"><span class="float-right"><a href="" class="text-dark"><small>Clear All</small></a> </span>Notification</h6>
									</div>

									<div class="slimscroll" style="max-height: 230px;">
										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-success"><i class="mdi mdi-comment-account-outline"></i></div>
											<p class="notify-details">Caleb Flakelar commented on Admin<small class="text-muted">1 min ago</small></p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-info"><i class="mdi mdi-account-plus"></i></div>
											<p class="notify-details">New user registered.<small class="text-muted">5 hours ago</small></p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-danger"><i class="mdi mdi-heart"></i></div>
											<p class="notify-details">Carlos Crouch liked <b>Admin</b><small class="text-muted">3 days ago</small></p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-warning"><i class="mdi mdi-comment-account-outline"></i></div>
											<p class="notify-details">Caleb Flakelar commented on Admin<small class="text-muted">4 days ago</small></p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-purple"><i class="mdi mdi-account-plus"></i></div>
											<p class="notify-details">New user registered.<small class="text-muted">7 days ago</small></p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon bg-custom"><i class="mdi mdi-heart"></i></div>
											<p class="notify-details">Carlos Crouch liked <b>Admin</b><small class="text-muted">13 days ago</small></p>
										</a>
									</div>

									<!-- All-->
									<a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
										View all <i class="fi-arrow-right"></i>
									</a>

								</div>
							</li>

							<li class="dropdown notification-list">
								<a class="nav-link dropdown-toggle arrow-none waves-effect" data-toggle="dropdown" href="#" role="button"
								 aria-haspopup="false" aria-expanded="false">
									<i class="fi-speech-bubble noti-icon"></i>
									<span class="badge badge-dark badge-pill noti-icon-badge">6</span>
								</a>
								<div class="dropdown-menu dropdown-menu-right dropdown-lg">

									<!-- item-->
									<div class="dropdown-item noti-title">
										<h6 class="m-0"><span class="float-right"><a href="" class="text-dark"><small>Clear All</small></a> </span>Chat</h6>
									</div>

									<div class="slimscroll" style="max-height: 230px;">
										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon"><img src="assets/images/users/avatar-2.jpg" class="img-fluid rounded-circle" alt="" />
											</div>
											<p class="notify-details">Cristina Pride</p>
											<p class="text-muted font-13 mb-0 user-msg">Hi, How are you? What about our next meeting</p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon"><img src="assets/images/users/avatar-3.jpg" class="img-fluid rounded-circle" alt="" />
											</div>
											<p class="notify-details">Sam Garret</p>
											<p class="text-muted font-13 mb-0 user-msg">Yeah everything is fine</p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon"><img src="assets/images/users/avatar-4.jpg" class="img-fluid rounded-circle" alt="" />
											</div>
											<p class="notify-details">Karen Robinson</p>
											<p class="text-muted font-13 mb-0 user-msg">Wow that's great</p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon"><img src="assets/images/users/avatar-5.jpg" class="img-fluid rounded-circle" alt="" />
											</div>
											<p class="notify-details">Sherry Marshall</p>
											<p class="text-muted font-13 mb-0 user-msg">Hi, How are you? What about our next meeting</p>
										</a>

										<!-- item-->
										<a href="javascript:void(0);" class="dropdown-item notify-item">
											<div class="notify-icon"><img src="assets/images/users/avatar-6.jpg" class="img-fluid rounded-circle" alt="" />
											</div>
											<p class="notify-details">Shawn Millard</p>
											<p class="text-muted font-13 mb-0 user-msg">Yeah everything is fine</p>
										</a>
									</div>

									<!-- All-->
									<a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
										View all <i class="fi-arrow-right"></i>
									</a>

								</div>
							</li>

							<li class="dropdown notification-list">
								<a class="nav-link dropdown-toggle waves-effect nav-user" data-toggle="dropdown" href="#" role="button"
								 aria-haspopup="false" aria-expanded="false">
									<img src="assets/images/users/avatar-1.jpg" alt="user" class="rounded-circle"> <span class="ml-1 pro-user-name">Maxine
										K <i class="mdi mdi-chevron-down"></i> </span>
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<!-- item-->
									<div class="dropdown-item noti-title">
										<h6 class="text-overflow m-0">Welcome !</h6>
									</div>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item notify-item">
										<i class="fi-head"></i> <span>My Account</span>
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item notify-item">
										<i class="fi-cog"></i> <span>Settings</span>
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item notify-item">
										<i class="fi-help"></i> <span>Support</span>
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item notify-item">
										<i class="fi-lock"></i> <span>Lock Screen</span>
									</a>

									<!-- item-->
									<a href="javascript:void(0);" class="dropdown-item notify-item">
										<i class="fi-power"></i> <span>Logout</span>
									</a>

								</div>
							</li>
						</ul>
					</div>
					<!-- end menu-extras -->

					<div class="clearfix"></div>

				</div> <!-- end container -->
			</div>
			<!-- end topbar-main -->

		</header>
		<!-- End Navigation Bar-->


		<div class="wrapper">
			<div class="container-fluid">

				<!-- Page-Title -->
				<div class="row">
					<div class="col-sm-12">
						<div class="page-title-box">
							<!-- <div class="btn-group pull-right">
								<ol class="breadcrumb hide-phone p-0 m-0">
									<li class="breadcrumb-item"><a href="#"></a></li>
									<li class="breadcrumb-item"><a href="#">Components</a></li>
									<li class="breadcrumb-item"><a href="#">Tables</a></li>
									<li class="breadcrumb-item active">Foo Tables</li>
								</ol>
							</div> -->
							<h4 class="page-title"><i class=" mdi mdi-bowl" style="display: inline;">待烹饪菜单</i></h4>
						</div>
					</div>
				</div>
				<!-- end page title end breadcrumb -->

				<!-- 展示菜品详细信息 -->
				<div class="row">
					<div class="col-12">
						<div class="card-box">
							<p class="text-muted m-b-30 font-13">
								让美味溢于舌尖
							</p>

							<!-- <div class="mb-3">
								<div class="row">
									<div class="col-12 text-sm-center form-inline">
										<div class="form-group mr-2">
											<select id="demo-foo-filter-status" class="custom-select">
												<option value="">展示所有</option>
												<option value="待烹饪">待烹饪</option>
												<option value="已烹饪">已烹饪</option>
												<option value="已取消">已取消</option> -->
												<!-- <option value="suspended">Suspended</option> -->
											<!-- </select>
										</div>
										<div class="form-group">
											<input id="demo-foo-search" type="text" placeholder="Search" class="form-control" autocomplete="on">
										</div>
									</div>
								</div>
							</div> -->
							<table id="demo-foo-filtering" class="table table-striped table-bordered toggle-circle m-b-0" data-page-size="7">
								<thead>
									<tr>
										<th data-toggle="true">菜品名</th>
										<th>桌号</th>
										<th data-hide="phone">菜品编号</th>
										<th data-hide="phone, tablet" data-sort-ignore="true">菜品数量</th>
										<th data-hide="phone, tablet">备注</th>
									</tr>
								</thead>
								<tbody>
								</tbody>
								<tfoot>
									<tr class="active">
										<td colspan="6">
											<div class="text-right">
												<ul class="pagination pagination-split justify-content-end footable-pagination m-t-10 m-b-0"></ul>
											</div>
										</td>
									</tr>
								</tfoot>
							</table>
						</div>
					</div>
				</div>
				<!-- 菜品详细信息展示结束 -->

			</div> <!-- end container -->
		</div>
		<!-- end wrapper -->


		<!-- jQuery  -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/popper.min.js"></script>
		<script src="assets/js/bootstrap.min.js"></script>
		<script src="assets/js/waves.js"></script>
		<script src="assets/js/jquery.slimscroll.js"></script>

		<!--FooTable-->
		<script src="../plugins/footable/js/footable.all.min.js"></script>
		<!--FooTable Example-->
		<script src="assets/pages/jquery.footable.js"></script>

		<!-- App js -->
		<script src="assets/js/jquery.core.js"></script>
		<script src="assets/js/jquery.app.js"></script>

		<!-- 自定义脚本 -->
		<script>
			// window.onload = function()
			// {
			// 	footable = $('#demo-foo-filtering').data('footable');
			// 	let currentPage = footable.pageInfo.currentPage;
			// 	let pageSize = footable.pageInfo.pageSize;
				
			// 	$.ajaxSettings.async = false;//设置ajax为同步，以防执行顺序紊乱
			// 	$.get("http://localhost:8080/order/get_ordered_dishbystate",
			// 	{"state":1,"page_num":currentPage,"pagesize":100},
			// 	function(data,status){
			// 		if(status == "success")
			// 		{
			// 			console.log("before ajax")
			// 			// add data table_id
			// 			for(let i = 0;i<data.length;i++)
			// 			{
			// 				 get_tableid(data[i].order_id,function(result){
			// 					 data[i].table_id = result;
			// 					 console.log("gettable_id"+result)
			// 				 })
			// 			}
			// 		}
			// 		console.log(data);
			// 		dishtableinit(data);
			// 	})
			// 	$.ajaxSettings.async = true;
			// }
			
			// window.onload = function(){
			// 	dishtableinit(dishjson);
			// }
			
			// $(document).ready(function(){
					// footable = $('#demo-foo-filtering').data('footable');
					// let currentPage = footable.pageInfo.currentPage;
					// let pageSize = footable.pageInfo.pageSize;
					
					$.ajaxSettings.async = false;//设置ajax为同步，以防执行顺序紊乱
					$.get("http://39.98.127.39:8080/order/get_ordered_dishbystate",
					{"state":1,"page_num":0,"pagesize":100},
					function(data,status){
						if(status == "success")
						{
							console.log("before ajax")
							// add data table_id
							for(let i = 0;i<data.length;i++)
							{
								 get_tableid(data[i].order_id,function(result){
									 data[i].table_id = result;
									 console.log("gettable_id"+result)
								 })
							}
							console.log(data);
							dishtableinit(data);
						}
					})
					$.ajaxSettings.async = true;
			// });
			
			function get_tableid(id,mycallback)
			{
				//get order by order_id 
				$.get("http://39.98.127.39:8080/order/get_order_byid",
				{"order_id":id},
				function(data,status){//data不能通过return 传出去（在function里），这里通过回调函数处理
					if(status == "success")
					{
						mycallback(data.table_id);
					}
				},"json");
				//get table_id from order
			}
			
			function dishtableinit(jsondata) {
				for (var i = 0; i < jsondata.length; i++) {
					var dynamicnode = '<tr>' +
						'										<td>' + jsondata[i].dish_name + '</td>' +
						'										<td>' + jsondata[i].table_id + '</td>' +
						'										<td>' + jsondata[i].dish_id + '</td>' +
						'										<td>' + jsondata[i].dish_num + '</td>' +
						'										<td>' + jsondata[i].note	 + '</td>' +
						'</tr>';
					$("#demo-foo-filtering").append(dynamicnode);
				}
			}

			let dishjsonstr =
				'[{"dish_name":"小鸡炖蘑菇","dish_id":12345678981,"dish_num":3,"note":"不要辣，一点都不要,测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字测试过长文字","dish_state":1,"table_id":123},{"dish_name":"干锅牛蛙","dish_id":12345678982,"dish_num":1,"note":"微微辣就行","dish_state":0,"table_id":125},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124},{"dish_name":"小炒牛肉","dish_id":12345678985,"dish_num":1,"note":"要辣，重庆人都怕的那种","dish_state":-1,"table_id":124}]';
			let dishjson = JSON.parse(dishjsonstr);
			console.log(dishjson[0].dish_name);

			function dishstate(state) {
				if (state == -1) {
					return '<td><span class="badge label-table badge-secondary">已取消</span></td>';
				} else if (state == 0) {
					return '<td><span class="badge label-table badge-success">已烹饪</span></td>';
				} else if (state > 0) {
					return '<td><span class="badge label-table badge-danger">待烹饪:' + state + '</span></td>';
				}
			}

			function dishdelete() {
				alert("delete triggered");
			}

			function dishcook() {
				alert("dishcook function triggered");
			}
			
			function floatshow(target)
			{ 
				  // $(target).attr("title",target.innerText);
				  target.setAttribute("title",target.innerText);
			}

			// dishtableinit(dishjson);
		</script>

		<!-- test -->
		<script>
			// console.log(dishjson);
			// console.log(dishtest);
			// console.log(localStorage.getItem("order_id"));//后期根据这个id获取菜品列表
		</script>

	</body>
</html>
